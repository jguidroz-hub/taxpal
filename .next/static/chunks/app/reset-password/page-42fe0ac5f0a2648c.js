(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[700],{63:(e,r,t)=>{"use strict";var a=t(7260);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},1009:(e,r,t)=>{Promise.resolve().then(t.bind(t,6092))},6092:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var a=t(5155),s=t(2115),n=t(63),d=t(2619),l=t.n(d);function o(){let e=(0,n.useSearchParams)().get("token"),[r,t]=(0,s.useState)(!1),[d,o]=(0,s.useState)(""),[i,c]=(0,s.useState)("");if(!e){let e=async e=>{e.preventDefault(),t(!0),c(""),o("");let r=new FormData(e.currentTarget).get("email");try{let e=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.toLowerCase().trim()})}),t=await e.json();if(!e.ok)throw Error(t.error);o(t.message)}catch(e){c(e.message||"Failed to send reset email")}finally{t(!1)}};return(0,a.jsxs)("form",{onSubmit:e,className:"space-y-5",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Reset your password"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Enter your email and we'll send a reset link"})]}),d&&(0,a.jsx)("div",{className:"rounded-lg bg-green-50 dark:bg-green-900/20 px-4 py-3 text-sm text-green-700 dark:text-green-400",children:d}),i&&(0,a.jsx)("div",{className:"rounded-lg bg-red-50 dark:bg-red-900/20 px-4 py-3 text-sm text-red-600 dark:text-red-400",children:i}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Email"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",required:!0,autoComplete:"email",className:"block w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 px-4 py-2.5 text-gray-900 dark:text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition",placeholder:"you@example.com"})]}),(0,a.jsx)("button",{type:"submit",disabled:r,className:"w-full rounded-lg bg-blue-600 px-4 py-2.5 text-white font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:r?"Sending...":"Send reset link"}),(0,a.jsx)("p",{className:"text-center text-sm text-gray-500",children:(0,a.jsx)(l(),{href:"/login",className:"text-blue-600 hover:text-blue-500 font-medium",children:"← Back to login"})})]})}let m=async r=>{r.preventDefault(),t(!0),c(""),o("");let a=new FormData(r.currentTarget),s=a.get("password");if(s!==a.get("confirm")){c("Passwords do not match"),t(!1);return}if(s.length<8){c("Password must be at least 8 characters"),t(!1);return}try{let r=await fetch("/api/auth/reset-password/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,password:s})}),t=await r.json();if(!r.ok)throw Error(t.error);o("Password reset! You can now sign in.")}catch(e){c(e.message||"Failed to reset password")}finally{t(!1)}};return(0,a.jsxs)("form",{onSubmit:m,className:"space-y-5",children:[(0,a.jsx)("div",{className:"text-center mb-6",children:(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Set new password"})}),d&&(0,a.jsxs)("div",{className:"rounded-lg bg-green-50 dark:bg-green-900/20 px-4 py-3 text-sm text-green-700 dark:text-green-400",children:[d," ",(0,a.jsx)(l(),{href:"/login",className:"font-medium underline",children:"Sign in →"})]}),i&&(0,a.jsx)("div",{className:"rounded-lg bg-red-50 dark:bg-red-900/20 px-4 py-3 text-sm text-red-600 dark:text-red-400",children:i}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"New password"}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",required:!0,minLength:8,className:"block w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 px-4 py-2.5 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition",placeholder:"At least 8 characters"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirm",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Confirm password"}),(0,a.jsx)("input",{id:"confirm",name:"confirm",type:"password",required:!0,minLength:8,className:"block w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 px-4 py-2.5 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition",placeholder:"Confirm your password"})]}),(0,a.jsx)("button",{type:"submit",disabled:r,className:"w-full rounded-lg bg-blue-600 px-4 py-2.5 text-white font-medium hover:bg-blue-700 disabled:opacity-50 transition",children:r?"Resetting...":"Reset password"})]})}function i(){return(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 dark:bg-gray-950 px-4",children:(0,a.jsx)("div",{className:"w-full max-w-md rounded-2xl bg-white p-8 shadow-sm border border-gray-100 dark:bg-gray-900 dark:border-gray-800",children:(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Loading..."}),children:(0,a.jsx)(o,{})})})})}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=1009)),_N_E=e.O()}]);